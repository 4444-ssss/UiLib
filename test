local P=game:GetService("Players").LocalPlayer
local UIS=game:GetService("UserInputService")
local RS=game:GetService("RunService")
local TS=game:GetService("TweenService")

local function guiParent()
    if syn and syn.protect_gui then
        local sg=Instance.new("ScreenGui")
        sg.IgnoreGuiInset=true
        sg.ZIndexBehavior=Enum.ZIndexBehavior.Global
        sg.Name="SmoothMiniUI"
        syn.protect_gui(sg)
        sg.Parent=game:GetService("CoreGui")
        return sg
    end
    local ok,ui=pcall(function() return gethui() end)
    local sg=Instance.new("ScreenGui")
    sg.IgnoreGuiInset=true
    sg.ZIndexBehavior=Enum.ZIndexBehavior.Global
    sg.Name="SmoothMiniUI"
    sg.Parent=(ok and ui) or game:GetService("CoreGui")
    return sg
end

local existing=(game.CoreGui:FindFirstChild("SmoothMiniUI") or (gethui and gethui():FindFirstChild("SmoothMiniUI")))
if existing then existing:Destroy() end

local SG=guiParent()
local Accent=Color3.fromRGB(86,156,214)
local Bkg=Color3.fromRGB(22,22,24)
local Bkg2=Color3.fromRGB(16,16,18)
local StrokeC=Color3.fromRGB(56,56,62)
local TextC=Color3.fromRGB(235,235,240)
local SubC=Color3.fromRGB(180,180,190)

local Main=Instance.new("Frame")
Main.Name="Main"
Main.Size=UDim2.fromOffset(380,280)
Main.Position=UDim2.new(0.5,-190,0.5,-140)
Main.BackgroundColor3=Bkg
Main.BorderSizePixel=0
Main.AnchorPoint=Vector2.new(0.5,0.5)
Main.Parent=SG

local Corner=Instance.new("UICorner",Main)
Corner.CornerRadius=UDim.new(0,14)

local Stroke=Instance.new("UIStroke",Main)
Stroke.Color=StrokeC
Stroke.Thickness=1

local Shadow=Instance.new("Frame")
Shadow.BackgroundColor3=Color3.new(0,0,0)
Shadow.BackgroundTransparency=0.8
Shadow.BorderSizePixel=0
Shadow.Size=UDim2.new(1,26,1,26)
Shadow.Position=UDim2.fromOffset(-13,-4)
Shadow.ZIndex=0
Shadow.Parent=Main
local SCorner=Instance.new("UICorner",Shadow)
SCorner.CornerRadius=UDim.new(0,18)

local Top=Instance.new("Frame")
Top.Name="Top"
Top.BackgroundColor3=Bkg2
Top.BorderSizePixel=0
Top.Size=UDim2.new(1,0,0,36)
Top.Parent=Main
local TCorner=Instance.new("UICorner",Top)
TCorner.CornerRadius=UDim.new(0,14)

local TopMask=Instance.new("Frame",Top)
TopMask.BackgroundTransparency=1
TopMask.Size=UDim2.new(1,0,1,0)
TopMask.ZIndex=2

local Title=Instance.new("TextLabel")
Title.BackgroundTransparency=1
Title.Text="Smooth Mini UI"
Title.Font=Enum.Font.GothamMedium
Title.TextSize=14
Title.TextColor3=TextC
Title.TextXAlignment=Enum.TextXAlignment.Left
Title.Position=UDim2.fromOffset(14,0)
Title.Size=UDim2.new(1,-160,1,0)
Title.Parent=Top

local AccentBar=Instance.new("Frame")
AccentBar.BackgroundColor3=Accent
AccentBar.BorderSizePixel=0
AccentBar.Size=UDim2.new(0,38,0,2)
AccentBar.Position=UDim2.fromOffset(14,34)
AccentBar.Parent=Top

local BtnClose=Instance.new("TextButton")
BtnClose.Text="×"
BtnClose.Font=Enum.Font.GothamBold
BtnClose.TextSize=18
BtnClose.AutoButtonColor=false
BtnClose.TextColor3=SubC
BtnClose.BackgroundTransparency=1
BtnClose.Size=UDim2.fromOffset(36,36)
BtnClose.Position=UDim2.new(1,-36,0,0)
BtnClose.Parent=Top

local BtnMin=Instance.new("TextButton")
BtnMin.Text="–"
BtnMin.Font=Enum.Font.GothamBold
BtnMin.TextSize=18
BtnMin.AutoButtonColor=false
BtnMin.TextColor3=SubC
BtnMin.BackgroundTransparency=1
BtnMin.Size=UDim2.fromOffset(36,36)
BtnMin.Position=UDim2.new(1,-72,0,0)
BtnMin.Parent=Top

local Body=Instance.new("Frame")
Body.Name="Body"
Body.BackgroundTransparency=1
Body.Size=UDim2.new(1,-20,1,-52)
Body.Position=UDim2.fromOffset(10,46)
Body.Parent=Main

local List=Instance.new("UIListLayout",Body)
List.Padding=UDim.new(0,10)
List.SortOrder=Enum.SortOrder.LayoutOrder

local function mkLabel(t)
    local l=Instance.new("TextLabel")
    l.BackgroundTransparency=1
    l.Font=Enum.Font.Gotham
    l.Text=t
    l.TextSize=13
    l.TextXAlignment=Enum.TextXAlignment.Left
    l.TextColor3=SubC
    l.Size=UDim2.new(1,0,0,16)
    return l
end

local function mkCard(h)
    local f=Instance.new("Frame")
    f.BackgroundColor3=Bkg2
    f.BorderSizePixel=0
    f.Size=UDim2.new(1,0,0,h or 44)
    local c=Instance.new("UICorner",f)
    c.CornerRadius=UDim.new(0,10)
    local s=Instance.new("UIStroke",f)
    s.Color=StrokeC
    s.Thickness=1
    return f
end

local function pulse(v)
    TS:Create(v,TweenInfo.new(.15,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{BackgroundColor3=Bkg}):Play()
    task.delay(.15,function()
        TS:Create(v,TweenInfo.new(.35,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{BackgroundColor3=Bkg2}):Play()
    end)
end

local function ripple(parent,px,py)
    local r=Instance.new("Frame")
    r.BackgroundColor3=Accent
    r.BackgroundTransparency=.35
    r.BorderSizePixel=0
    r.AnchorPoint=Vector2.new(.5,.5)
    r.Position=UDim2.fromOffset(px,py)
    r.Size=UDim2.fromOffset(0,0)
    r.ZIndex=50
    local rc=Instance.new("UICorner",r)
    rc.CornerRadius=UDim.new(1,0)
    r.Parent=parent
    local d=math.max(parent.AbsoluteSize.X,parent.AbsoluteSize.Y)*1.2
    TS:Create(r,TweenInfo.new(.35,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{Size=UDim2.fromOffset(d,d),BackgroundTransparency=1}):Play()
    task.delay(.4,function() r:Destroy() end)
end

local function applyAccent()
    AccentBar.BackgroundColor3=Accent
    Stroke.Color=StrokeC
end

applyAccent()

local Drag=false
local DragStart,StartPos
Top.InputBegan:Connect(function(i)
    if i.UserInputType==Enum.UserInputType.MouseButton1 then
        Drag=true
        DragStart=i.Position
        StartPos=Main.Position
    end
end)
UIS.InputEnded:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton1 then Drag=false end end)
UIS.InputChanged:Connect(function(i)
    if Drag and i.UserInputType==Enum.UserInputType.MouseMovement then
        local delta=i.Position-DragStart
        Main.Position=UDim2.new(StartPos.X.Scale,StartPos.X.Offset+delta.X,StartPos.Y.Scale,StartPos.Y.Offset+delta.Y)
    end
end)

TS:Create(Main,TweenInfo.new(.22,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{Size=UDim2.fromOffset(388,292)}):Play()
task.delay(.22,function()
    TS:Create(Main,TweenInfo.new(.22,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{Size=UDim2.fromOffset(380,280)}):Play()
end)

BtnClose.MouseEnter:Connect(function() BtnClose.TextColor3=TextC end)
BtnClose.MouseLeave:Connect(function() BtnClose.TextColor3=SubC end)
BtnClose.MouseButton1Click:Connect(function() ripple(Top,BtnClose.AbsolutePosition.X-Top.AbsolutePosition.X+18,18) Main:Destroy() end)

local Min=false
BtnMin.MouseEnter:Connect(function() BtnMin.TextColor3=TextC end)
BtnMin.MouseLeave:Connect(function() BtnMin.TextColor3=SubC end)
BtnMin.MouseButton1Click:Connect(function(x,y)
    ripple(Top,BtnMin.AbsolutePosition.X-Top.AbsolutePosition.X+18,18)
    Min=not Min
    local h=Min and 36 or 280
    TS:Create(Main,TweenInfo.new(.25,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{Size=UDim2.fromOffset(380,h)}):Play()
end)

local ToggleCard=mkCard(52); ToggleCard.Parent=Body
local TL=mkLabel("Toggle"); TL.Parent=ToggleCard
TL.Position=UDim2.fromOffset(12,6)
local Switch=Instance.new("Frame"); Switch.Parent=ToggleCard
Switch.BackgroundColor3=Bkg
Switch.BorderSizePixel=0
Switch.Size=UDim2.fromOffset(54,22)
Switch.Position=UDim2.new(1,-66,0,15)
local SWC=Instance.new("UICorner",Switch); SWC.CornerRadius=UDim.new(1,0)
local SWS=Instance.new("UIStroke",Switch); SWS.Color=StrokeC
local Knob=Instance.new("Frame",Switch)
Knob.Size=UDim2.fromOffset(18,18); Knob.Position=UDim2.fromOffset(2,2)
Knob.BackgroundColor3=SubC; Knob.BorderSizePixel=0
local KC=Instance.new("UICorner",Knob); KC.CornerRadius=UDim.new(1,0)
local On=false
local function setToggle(v)
    On=v
    TS:Create(Knob,TweenInfo.new(.18,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{Position=v and UDim2.fromOffset(34,2) or UDim2.fromOffset(2,2),BackgroundColor3=v and Accent or SubC}):Play()
    TS:Create(Switch,TweenInfo.new(.18,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{BackgroundColor3=v and Color3.fromRGB(28,28,32) or Bkg}):Play()
end
Switch.InputBegan:Connect(function(i)
    if i.UserInputType==Enum.UserInputType.MouseButton1 then setToggle(not On); pulse(ToggleCard); ripple(ToggleCard,i.Position.X-ToggleCard.AbsolutePosition.X,i.Position.Y-ToggleCard.AbsolutePosition.Y) end
end)

local BtnCard=mkCard(52); BtnCard.Parent=Body
local BL=mkLabel("Button"); BL.Parent=BtnCard; BL.Position=UDim2.fromOffset(12,6)
local DoBtn=Instance.new("TextButton",BtnCard)
DoBtn.Text="Run Action"
DoBtn.Font=Enum.Font.GothamSemibold
DoBtn.TextSize=13
DoBtn.AutoButtonColor=false
DoBtn.TextColor3=TextC
DoBtn.BackgroundColor3=Accent
DoBtn.BorderSizePixel=0
DoBtn.Size=UDim2.fromOffset(120,28)
DoBtn.Position=UDim2.new(1,-132,0,12)
local DBC=Instance.new("UICorner",DoBtn); DBC.CornerRadius=UDim.new(0,8)
DoBtn.MouseEnter:Connect(function() TS:Create(DoBtn,TweenInfo.new(.12),{BackgroundColor3=Accent:Lerp(Color3.new(1,1,1),.1)}):Play() end)
DoBtn.MouseLeave:Connect(function() TS:Create(DoBtn,TweenInfo.new(.12),{BackgroundColor3=Accent}):Play() end)
DoBtn.MouseButton1Click:Connect(function(x,y) ripple(DoBtn,x-DoBtn.AbsolutePosition.X,y-DoBtn.AbsolutePosition.Y) pulse(BtnCard) end)

local BoxCard=mkCard(60); BoxCard.Parent=Body
local XL=mkLabel("Input"); XL.Parent=BoxCard; XL.Position=UDim2.fromOffset(12,6)
local Box=Instance.new("TextBox",BoxCard)
Box.PlaceholderText="type here..."
Box.Text=""
Box.Font=Enum.Font.Gotham
Box.TextSize=13
Box.TextColor3=TextC
Box.PlaceholderColor3=SubC
Box.BackgroundColor3=Bkg
Box.BorderSizePixel=0
Box.Size=UDim2.new(1,-24,0,30)
Box.Position=UDim2.fromOffset(12,22)
local XBC=Instance.new("UICorner",Box); XBC.CornerRadius=UDim.new(0,8)
local XBS=Instance.new("UIStroke",Box); XBS.Color=StrokeC
Box.Focused:Connect(function() TS:Create(XBS,TweenInfo.new(.15),{Color=Accent}):Play() end)
Box.FocusLost:Connect(function() TS:Create(XBS,TweenInfo.new(.2),{Color=StrokeC}):Play() pulse(BoxCard) end)

local DropCard=mkCard(120); DropCard.Parent=Body
local DL=mkLabel("Dropdown"); DL.Parent=DropCard; DL.Position=UDim2.fromOffset(12,6)
local Drop=Instance.new("Frame",DropCard)
Drop.BackgroundColor3=Bkg
Drop.BorderSizePixel=0
Drop.Size=UDim2.new(1,-24,0,30)
Drop.Position=UDim2.fromOffset(12,24)
local DPC=Instance.new("UICorner",Drop); DPC.CornerRadius=UDim.new(0,8)
local DPS=Instance.new("UIStroke",Drop); DPS.Color=StrokeC
local Cur=Instance.new("TextLabel",Drop)
Cur.BackgroundTransparency=1
Cur.Text="Select..."
Cur.Font=Enum.Font.Gotham
Cur.TextSize=13
Cur.TextXAlignment=Enum.TextXAlignment.Left
Cur.TextColor3=TextC
Cur.Position=UDim2.fromOffset(10,0)
Cur.Size=UDim2.new(1,-40,1,0)
local Arrow=Instance.new("TextLabel",Drop)
Arrow.BackgroundTransparency=1
Arrow.Text="▾"
Arrow.Font=Enum.Font.GothamBold
Arrow.TextSize=14
Arrow.TextColor3=SubC
Arrow.Position=UDim2.new(1,-26,0,0)
Arrow.Size=UDim2.fromOffset(20,30)
local ListFrame=Instance.new("Frame",DropCard)
ListFrame.BackgroundColor3=Bkg
ListFrame.BorderSizePixel=0
ListFrame.Visible=false
ListFrame.Size=UDim2.new(1,-24,0,0)
ListFrame.Position=UDim2.fromOffset(12,58)
local LCorner=Instance.new("UICorner",ListFrame); LCorner.CornerRadius=UDim.new(0,8)
local LStroke=Instance.new("UIStroke",ListFrame); LStroke.Color=StrokeC
local LList=Instance.new("UIListLayout",ListFrame); LList.Padding=UDim.new(0,6); LList.SortOrder=Enum.SortOrder.LayoutOrder
local Options={"Low","Medium","High","Ultra"}
local function addOpt(t)
    local o=Instance.new("TextButton")
    o.AutoButtonColor=false
    o.Text=t
    o.Font=Enum.Font.Gotham
    o.TextSize=13
    o.TextColor3=TextC
    o.BackgroundColor3=Bkg2
    o.BorderSizePixel=0
    o.Size=UDim2.new(1,-12,0,28)
    o.Position=UDim2.fromOffset(6,0)
    local oc=Instance.new("UICorner",o); oc.CornerRadius=UDim.new(0,6)
    o.MouseEnter:Connect(function() TS:Create(o,TweenInfo.new(.1),{BackgroundColor3=Color3.fromRGB(26,26,30)}):Play() end)
    o.MouseLeave:Connect(function() TS:Create(o,TweenInfo.new(.1),{BackgroundColor3=Bkg2}):Play() end)
    o.MouseButton1Click:Connect(function(x,y)
        Cur.Text=t
        ripple(o,x-o.AbsolutePosition.X,y-o.AbsolutePosition.Y)
        TS:Create(ListFrame,TweenInfo.new(.18,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{Size=UDim2.new(1,-24,0,0)}):Play()
        task.delay(.18,function() ListFrame.Visible=false end)
        pulse(DropCard)
    end)
    o.Parent=ListFrame
end
for _,t in ipairs(Options) do addOpt(t) end
local openDrop=false
local function toggleDrop()
    openDrop=not openDrop
    if openDrop then
        ListFrame.Visible=true
        local targetH= (#Options*34)+12
        TS:Create(ListFrame,TweenInfo.new(.18,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{Size=UDim2.new(1,-24,0,targetH)}):Play()
    else
        TS:Create(ListFrame,TweenInfo.new(.18,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{Size=UDim2.new(1,-24,0,0)}):Play()
        task.delay(.18,function() ListFrame.Visible=false end)
    end
end
Drop.InputBegan:Connect(function(i)
    if i.UserInputType==Enum.UserInputType.MouseButton1 then
        toggleDrop()
        ripple(Drop,i.Position.X-Drop.AbsolutePosition.X,i.Position.Y-Drop.AbsolutePosition.Y)
    end
end)

local PickerCard=mkCard(82); PickerCard.Parent=Body
local PL=mkLabel("Theme"); PL.Parent=PickerCard; PL.Position=UDim2.fromOffset(12,6)
local Bar=Instance.new("Frame",PickerCard)
Bar.BackgroundColor3=Bkg
Bar.BorderSizePixel=0
Bar.Size=UDim2.new(1,-24,0,16)
Bar.Position=UDim2.fromOffset(12,28)
local BC=Instance.new("UICorner",Bar); BC.CornerRadius=UDim.new(0,8)
local BG=Instance.new("Frame",Bar)
BG.BackgroundColor3=Color3.new(1,1,1)
BG.BorderSizePixel=0
BG.Size=UDim2.new(1,-4,1,-4)
BG.Position=UDim2.fromOffset(2,2)
local BGC=Instance.new("UICorner",BG); BGC.CornerRadius=UDim.new(0,6)
local Grad=Instance.new("UIGradient",BG)
Grad.Color=ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromHSV(0,1,1)),
    ColorSequenceKeypoint.new(1/6, Color3.fromHSV(1/6,1,1)),
    ColorSequenceKeypoint.new(2/6, Color3.fromHSV(2/6,1,1)),
    ColorSequenceKeypoint.new(3/6, Color3.fromHSV(3/6,1,1)),
    ColorSequenceKeypoint.new(4/6, Color3.fromHSV(4/6,1,1)),
    ColorSequenceKeypoint.new(5/6, Color3.fromHSV(5/6,1,1)),
    ColorSequenceKeypoint.new(1, Color3.fromHSV(1,1,1))
}
local Thumb=Instance.new("Frame",BG)
Thumb.Size=UDim2.fromOffset(6,20)
Thumb.AnchorPoint=Vector2.new(.5,.5)
Thumb.Position=UDim2.new(0,0,0.5,0)
Thumb.BackgroundColor3=Color3.fromRGB(255,255,255)
Thumb.BorderSizePixel=0
local ThC=Instance.new("UICorner",Thumb); ThC.CornerRadius=UDim.new(0,3)
local picking=false
local function setHueFromX(x)
    local rel=math.clamp((x-BG.AbsolutePosition.X)/BG.AbsoluteSize.X,0,1)
    Thumb.Position=UDim2.new(rel,0,.5,0)
    Accent=Color3.fromHSV(rel,0.9,1)
    DoBtn.BackgroundColor3=Accent
    Knob.BackgroundColor3=On and Accent or SubC
    AccentBar.BackgroundColor3=Accent
end
BG.InputBegan:Connect(function(i)
    if i.UserInputType==Enum.UserInputType.MouseButton1 then
        picking=true
        setHueFromX(i.Position.X)
    end
end)
UIS.InputEnded:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton1 then picking=false end end)
UIS.InputChanged:Connect(function(i)
    if picking and i.UserInputType==Enum.UserInputType.MouseMovement then
        setHueFromX(i.Position.X)
    end
end)

local Footer=Instance.new("TextLabel",Main)
Footer.BackgroundTransparency=1
Footer.Text="Ready"
Footer.Font=Enum.Font.Gotham
Footer.TextSize=12
Footer.TextColor3=SubC
Footer.TextXAlignment=Enum.TextXAlignment.Left
Footer.Position=UDim2.new(0,14,1,-20)
Footer.Size=UDim2.fromOffset(200,16)
